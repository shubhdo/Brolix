{"version":3,"sources":["webpack:///webpack/bootstrap 1ec8c8f0584aecfced0c","webpack:///./studio/main_dev.js","webpack:///./studio/ImageEditor.js","webpack:///external \"Studio.libraries['react']\"","webpack:///./studio/ImageUploadButton.js","webpack:///external \"Studio\""],"names":["addEntitySet","name","faIcon","visibleName","onNew","OpenUpload","helpUrl","entityTreePosition","addEditorComponent","addToolbarComponent","ImageEditor","entity","props","textTransform","overflow","contentType","content","display","margin","propTypes","PropTypes","object","isRequired","_imageUploadButton","ImageUploadButton","e","target","files","length","file","reader","FileReader","onloadend","refs","value","workspaces","save","forNew","api","post","attach","filename","response","__entitySet","_id","shortid","addExistingEntity","openTab","Object","assign","tab","loadEntity","onerror","alert","readAsBinaryString","dispatchEvent","MouseEvent","window","upload","renderUpload","openFileDialog","onUpdate","func"],"mappings":"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","file":"./studio/main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1ec8c8f0584aecfced0c\n **/","import ImageEditor from './ImageEditor.js'\nimport ImageUploadButton from './ImageUploadButton.js'\nimport Studio from 'jsreport-studio'\n\nStudio.addEntitySet({\n  name: 'images',\n  faIcon: 'fa-camera',\n  visibleName: 'image',\n  onNew: ImageUploadButton.OpenUpload,\n  helpUrl: 'http://jsreport.net/learn/images',\n  entityTreePosition: 600\n})\n\nStudio.addEditorComponent('images', ImageEditor)\nStudio.addToolbarComponent(ImageUploadButton)\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/main_dev.js\n **/","import React, { Component } from 'react'\n\nexport default class ImageEditor extends Component {\n  static propTypes = {\n    entity: React.PropTypes.object.isRequired\n  }\n\n  render () {\n    const { entity } = this.props\n\n    return (<div className='custom-editor'>\n      <div><h1><i className='fa fa-camera' /> {entity.name}</h1></div>\n      <div>\n        <div>Embed into a html based template using data uri scheme:\n          <code>\n            <h2 style={{textTransform: 'none'}}>\n              &lt;img src='{'{#image ' + entity.name + \"}'\"}/&gt;\n            </h2>\n          </code>\n        </div>\n      </div>\n      <div>\n        <div>Embed using raw base64 encoding:\n          <code>\n            <h2 style={{textTransform: 'none'}}>\n              {'{#image ' + entity.name + ' @encoding=base64}'}\n            </h2>\n          </code>\n        </div>\n      </div>\n\n      <div style={{overflow: 'auto'}}>\n        <img src={'data:' + entity.contentType + ';base64,' + entity.content} style={{display: 'block', margin: '3rem auto'}} />\n      </div>\n    </div>)\n  }\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/ImageEditor.js\n **/","module.exports = Studio.libraries['react'];\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio.libraries['react']\"\n ** module id = 2\n ** module chunks = 0\n **/","import React, { Component } from 'react'\nimport Studio from 'jsreport-studio'\n\nlet _imageUploadButton\n\nexport default class ImageUploadButton extends Component {\n  static propTypes = {\n    tab: React.PropTypes.object,\n    onUpdate: React.PropTypes.func.isRequired\n  }\n\n  // we need to have global action in main_dev which is triggered when users clicks on + on images\n  // this triggers invisible button in the toolbar\n  static OpenUpload () {\n    _imageUploadButton.openFileDialog(true)\n  }\n\n  componentDidMount () {\n    _imageUploadButton = this\n  }\n\n  upload (e) {\n    if (!e.target.files.length) {\n      return\n    }\n\n    const file = e.target.files[0]\n    const reader = new FileReader()\n\n    reader.onloadend = async () => {\n      this.refs.file.value = ''\n      // playground/workspaces extension needs to save the new version\n      // so uploading of the new image goes into it\n      if (Studio.workspaces) {\n        await Studio.workspaces.save()\n      }\n\n      if (this.forNew) {\n        const response = await Studio.api.post('/api/image', {\n          attach: { filename: 'file.png', file: file }\n        })\n\n        const entity = {\n          __entitySet: 'images',\n          _id: response._id,\n          name: response.name,\n          shortid: response.shortid\n        }\n\n        Studio.addExistingEntity(entity)\n        Studio.openTab(Object.assign({}, entity))\n      } else {\n        await Studio.api.post(`/api/image/${this.props.tab.entity.shortid}`, {\n          attach: { filename: 'file.png', file: file }\n        })\n\n        Studio.loadEntity(this.props.tab.entity._id, true)\n      }\n    }\n\n    reader.onerror = function () {\n      alert('There was an error reading the file!')\n    }\n\n    reader.readAsBinaryString(file)\n  }\n\n  openFileDialog (forNew) {\n    this.forNew = forNew\n\n    this.refs.file.dispatchEvent(new MouseEvent('click', {\n      'view': window,\n      'bubbles': false,\n      'cancelable': true\n    }))\n  }\n\n  renderUpload () {\n    return <input type='file' key='file' ref='file' style={{display: 'none'}} onChange={(e) => this.upload(e)} accept='image/*' />\n  }\n\n  render () {\n    if (!this.props.tab || !this.props.tab.entity || this.props.tab.entity.__entitySet !== 'images') {\n      return this.renderUpload(true)\n    }\n\n    return <div className='toolbar-button' onClick={() => { this.openFileDialog() }}>\n      <i className='fa fa-cloud-upload' />Upload\n      {this.renderUpload()}\n    </div>\n  }\n}\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./studio/ImageUploadButton.js\n **/","module.exports = Studio;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"Studio\"\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}